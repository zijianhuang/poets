"use strict";(self.webpackChunkpoemsng=self.webpackChunkpoemsng||[]).push([[682],{2682:(ge,Z,a)=>{a.r(Z),a.d(Z,{ReaderViewModule:()=>_e});var r=a(6895),U=a(9814),c=a(4006),P=a(7077),b=a(9299),Q=a(6818),e=a(4650),m=a(4401),C=a(5545),F=a(5599),u=a(3872),R=a(4859),S=a(3238),T=a(7392),v=a(6338),d=a(3267),M=a(3683),w=a(266),_=a(1576),E=a(6849),B=a(9291),y=a(1983);function L(n,i){if(1&n&&(e.TgZ(0,"mat-list-option",16,17)(2,"div",18)(3,"span",19),e._uU(4),e.qZA(),e.TgZ(5,"p",20),e._uU(6),e.ALo(7,"date"),e.qZA()()()),2&n){const t=i.$implicit;e.Q6J("value",t),e.xp6(4),e.Oqu(t.title),e.xp6(2),e.hij(" \xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0",e.xi3(7,3,t.published,"yyyy-MM-dd")," ")}}function V(n,i){if(1&n&&e._UZ(0,"album-meta-viewer",21),2&n){const t=e.oxw();e.Q6J("data",t.currentAlbum)("showTitle",!0)}}function G(n,i){if(1&n&&(e.TgZ(0,"div"),e._UZ(1,"poem-viewer",22,23)(3,"p"),e.qZA()),2&n){const t=i.$implicit,o=e.oxw();e.xp6(1),e.Q6J("data",t)("settings",o.albumPoemViewerSettings)}}function H(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",24),e.NdJ("click",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.copyToClipboard())}),e._UZ(1,"mat-icon",25),e.qZA()}}let D=(()=>{class n extends Q.k{constructor(t,o,l,s,p,f,h){super(t,o,l,s,p,h),this.alertService=t,this.albumsService=o,this.poemsService=l,this.basicDataLoaderService=s,this.waitService=p,this.ref=f,this.langSubjectService=h}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(m.c9),e.Y36(C.T.Albums),e.Y36(C.T.Poems),e.Y36(F.k),e.Y36(m.ii),e.Y36(e.sBO),e.Y36(u.IZ))},n.\u0275cmp=e.Xpm({type:n,selectors:[["albums-for-reader"]],features:[e.qOj],decls:25,vars:6,consts:function(){let i;return i="Copy album to clipboard",[[1,"fixed-top"],["fxLayoutGap","1em"],["toolbar",""],[1,"toolbar-spacer"],["mat-button","","mat-raised-button","","mat-icon-button","","type","button",3,"click"],["hasBackdrop","false","scrollable",""],["mode","over","opened","","fxFlex","50","fixedInViewport","true","position","end","autoFocus","false",3,"fixedTopGap"],["sidenav",""],["sidenavContent",""],[3,"multiple","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["fxFlex","auto","fixedInViewport","true"],[3,"data","showTitle",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"viewer-margin"],["mat-button","","mat-raised-button","","mat-icon-button","","matTooltip",i,3,"click",4,"ngIf"],[3,"value"],["ca","matListOption"],["mat-line",""],[1,"album-title-list"],[1,"published"],[3,"data","showTitle"],[3,"data","settings"],["poemViewers",""],["mat-button","","mat-raised-button","","mat-icon-button","","matTooltip",i,3,"click"],["color","primary","svgIcon","c_clipboard_copy"]]},template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"mat-toolbar",1,2),e._UZ(3,"main-buttons")(4,"span",3),e.TgZ(5,"button",4),e.NdJ("click",function(){return o.toggleSidenav()}),e.TgZ(6,"mat-icon"),e._uU(7,"reorder"),e.qZA()()()(),e.TgZ(8,"div")(9,"mat-sidenav-container",5)(10,"mat-sidenav",6,7)(12,"div",null,8)(14,"mat-selection-list",9),e.NdJ("selectionChange",function(s){return o.handleAlbumChange(s)}),e.YNc(15,L,8,6,"mat-list-option",10),e.qZA()()(),e.TgZ(16,"mat-sidenav-content",11),e.YNc(17,V,1,2,"album-meta-viewer",12),e._UZ(18,"p"),e.YNc(19,G,4,2,"div",13),e._UZ(20,"p"),e.TgZ(21,"div",14),e.YNc(22,H,2,0,"button",15),e.qZA(),e._UZ(23,"p"),e.qZA()(),e._UZ(24,"p"),e.qZA()),2&t&&(e.xp6(10),e.Q6J("fixedTopGap",o.mainToolbarHeight),e.xp6(4),e.Q6J("multiple",!1),e.xp6(1),e.Q6J("ngForOf",o.albums),e.xp6(2),e.Q6J("ngIf",o.currentAlbum.id),e.xp6(2),e.Q6J("ngForOf",o.poemsOfAlbum),e.xp6(3),e.Q6J("ngIf",o.currentAlbum.id&&o.copyAlbumEnabled))},dependencies:[r.sg,r.O5,R.lW,S.X2,T.Hw,v.Ub,v.vS,d.JX,d.TM,d.Rh,M.Ye,w.gM,_.SQ,_.yH,E.X,B.E,y.d,r.uU],encapsulation:2}),n})();var $=a(9019),g=a(5529),j=a(6900),X=a(4308),W=a(8353),K=a(7516),z=a(6709),J=a(7331),x=a(7084),N=a(782),A=a(9549),k=a(284),q=a(5829);function ee(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"mat-chip",30,31),e.NdJ("click",function(){e.CHM(t);const l=e.MAs(1),s=e.oxw(4);return e.KtG(s.handleTagClick(l))}),e._uU(2),e.qZA()}if(2&n){const t=i.$implicit;e.Q6J("value",t.id),e.xp6(2),e.hij(" ",t.name," ")}}function te(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"mat-chip-list",27,28),e.NdJ("change",function(l){e.CHM(t);const s=e.oxw(3);return e.KtG(s.handleTagsChange(l))}),e.YNc(2,ee,3,2,"mat-chip",29),e.qZA()}if(2&n){const t=e.oxw(3);e.xp6(2),e.Q6J("ngForOf",t.tags)}}function ne(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"mat-chip",30,31),e.NdJ("click",function(){e.CHM(t);const l=e.MAs(1),s=e.oxw(4);return e.KtG(s.handleTagClick(l))}),e._uU(2),e.qZA()}if(2&n){const t=i.$implicit;e.Q6J("value",t.id),e.xp6(2),e.hij(" ",t.name," ")}}function oe(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"mat-chip-list",32,28),e.NdJ("change",function(l){e.CHM(t);const s=e.oxw(3);return e.KtG(s.handleTagsChange(l))}),e.YNc(2,ne,3,2,"mat-chip",29),e.qZA()}if(2&n){const t=e.oxw(3);e.xp6(2),e.Q6J("ngForOf",t.tags)}}function ie(n,i){if(1&n&&(e.TgZ(0,"mat-expansion-panel")(1,"mat-expansion-panel-header")(2,"mat-panel-title"),e.SDv(3,22),e.qZA(),e.TgZ(4,"mat-panel-description"),e._uU(5),e.qZA()(),e.TgZ(6,"div")(7,"mat-checkbox",23),e._uU(8,"Filtered by multiple tags"),e.qZA()(),e.TgZ(9,"div",24),e.YNc(10,te,3,1,"mat-chip-list",25),e.YNc(11,oe,3,1,"mat-chip-list",26),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(5),e.hij(" ",t.tagNames," "),e.xp6(2),e.Q6J("formControl",t.multipleTagsControl),e.xp6(3),e.Q6J("ngIf",t.multipleTagsControl.value),e.xp6(1),e.Q6J("ngIf",!t.multipleTagsControl.value)}}function ae(n,i){if(1&n&&(e.TgZ(0,"p",37),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw().$implicit;let o;e.Q6J("ngClass",t.published?"published":"draft"),e.xp6(1),e.hij(" \xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0",e.xi3(2,2,null!==(o=t.published)&&void 0!==o?o:t.date,"yyyy-MM-dd")," ")}}function le(n,i){if(1&n&&(e.TgZ(0,"mat-list-option",33,34)(2,"div",35),e._uU(3),e.YNc(4,ae,3,5,"p",36),e.qZA()()),2&n){const t=i.$implicit,o=e.oxw(2);e.Q6J("value",t.id),e.xp6(3),e.hij(" ",t.title," "),e.xp6(1),e.Q6J("ngIf",o.usePublished)}}function se(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"mat-sidenav-container",1)(1,"mat-sidenav",2,3)(3,"div",null,4),e.YNc(5,ie,12,4,"mat-expansion-panel",5),e._UZ(6,"div",6),e.TgZ(7,"mat-grid-list",7)(8,"mat-grid-tile",8)(9,"div",9)(10,"form",10,11),e.NdJ("ngSubmit",function(){e.CHM(t);const l=e.MAs(11),s=e.oxw();return e.KtG(l.form.valid&&s.search())}),e.TgZ(12,"mat-form-field",9)(13,"mat-label"),e.SDv(14,12),e.qZA(),e._UZ(15,"input",13),e.TgZ(16,"button",14)(17,"mat-icon"),e._uU(18,"search"),e.qZA()(),e.TgZ(19,"button",15),e.NdJ("click",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.clearKeywords())}),e.TgZ(20,"mat-icon"),e._uU(21,"close"),e.qZA()()()()()(),e.TgZ(22,"mat-grid-tile",8)(23,"label",16),e._uU(24),e.qZA()()(),e.TgZ(25,"mat-selection-list",17,18),e.NdJ("selectionChange",function(l){e.CHM(t);const s=e.oxw();return e.KtG(s.handlePoemListChange(l))}),e.YNc(27,le,5,3,"mat-list-option",19),e.qZA()()(),e.TgZ(28,"mat-sidenav-content",20),e._UZ(29,"poem-viewer",21)(30,"p"),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("fixedTopGap",t.fixedTopGap),e.xp6(4),e.Q6J("ngIf",t.tags.length>0),e.xp6(3),e.Q6J("colspan",3),e.xp6(7),e.s9C("placeholder",t.searchBoxPlaceHolder),e.Q6J("formControl",t.keywordsControl),e.xp6(1),e.Q6J("disabled",!t.keywordsControl.value),e.xp6(3),e.Q6J("disabled",!t.keywordsControl.value),e.xp6(3),e.Q6J("colspan",1),e.xp6(2),e.Oqu(t.filteredPoemBriefs.length),e.xp6(1),e.Q6J("multiple",!1),e.xp6(2),e.Q6J("ngForOf",t.filteredPoemBriefs),e.xp6(2),e.Q6J("data",t.currentPoem)("settings",t.poemViewerSettings)}}let re=(()=>{class n extends W.G{constructor(t,o,l,s,p,f,h,I,Y){super(t,o,l,p,I,Y),this.poemsService=t,this.alsertService=o,this.dataComponentDialogService=l,this.poemDeletedSubjectService=s,this.alertService=p,this.poemAssociationsChangedSubjectService=f,this.staticContentReloadSubjectService=h,this.langSubjectService=I,this.allMetaService=Y,this.staticContentReloadSubscription=this.staticContentReloadSubjectService.getMessage().subscribe(he=>{this.currentPoem={}})}ngOnDestroy(){this.staticContentReloadSubscription.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(C.T.Poems),e.Y36(m.c9),e.Y36(m.T4),e.Y36(u.VE),e.Y36(m.c9),e.Y36(u.ks),e.Y36(u.vw),e.Y36(u.IZ),e.Y36(K.j))},n.\u0275cmp=e.Xpm({type:n,selectors:[["chronicle-for-reader"]],features:[e.qOj],decls:1,vars:1,consts:function(){let i,t;return i="Search",t=" Tags ",[[3,"ngIf"],["hasBackdrop","false","scrollable",""],["mode","over","opened","","fxFlex","50","fixedInViewport","true","position","end","autoFocus","false",3,"fixedTopGap"],["sidenav",""],["sidenavContent",""],[4,"ngIf"],[1,"nav-space-block"],["name","search","cols","4","rowHeight","4em"],[3,"colspan"],["fxFlexFill",""],["name","searchForm",3,"ngSubmit"],["f","ngForm"],i,["matInput","",3,"formControl","placeholder"],["mat-button","","mat-icon-button","","matSuffix","","type","submit",3,"disabled"],["mat-button","","mat-icon-button","","matSuffix","",3,"disabled","click"],[1,"float-right"],[3,"multiple","selectionChange"],["poemsSelectionList",""],[3,"value",4,"ngFor","ngForOf"],["fxFlex","auto","fixedInViewport","true"],[3,"data","settings"],t,[3,"formControl"],[1,"scroll-tags"],["selectable","","multiple","true",3,"change",4,"ngIf"],["selectable","","multiple","false",3,"change",4,"ngIf"],["selectable","","multiple","true",3,"change"],["tagChipList",""],[3,"value","click",4,"ngFor","ngForOf"],[3,"value","click"],["c","matChip"],["selectable","","multiple","false",3,"change"],[3,"value"],["ca","matListOption"],["mat-line",""],[3,"ngClass",4,"ngIf"],[3,"ngClass"]]},template:function(t,o){1&t&&e.YNc(0,se,31,13,"ng-template",0),2&t&&e.Q6J("ngIf",!o.groupedByYearMonth)},dependencies:[r.mk,r.sg,r.O5,c._Y,c.Fj,c.JJ,c.JL,c.F,c.oH,R.lW,z.oG,J.qn,J.HS,x.ib,x.yz,x.yK,x.u4,N.Il,N.DX,S.X2,T.Hw,A.KE,A.hX,A.R9,k.Nt,v.Ub,v.vS,d.JX,d.TM,d.Rh,_.s9,_.yH,q.oO,E.X,r.uU],encapsulation:2}),n})();function ce(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",6),e.NdJ("click",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.reload())}),e.TgZ(1,"mat-icon"),e._uU(2,"refresh"),e.qZA()()}}let O=(()=>{class n extends j.A{constructor(t,o,l,s,p,f){super(t,l,s),this.alertService=t,this.poemsService=o,this.basicDataLoaderService=l,this.waitService=s,this.viewSettingsDialogService=p,this.staticContentReloadSubjectService=f,console.debug("MainForReaderComponent created"),this.staticContentReloadSubscription=this.staticContentReloadSubjectService.getMessage().subscribe(h=>{this.reload()})}ngOnInit(){console.debug("MainForReaderComponent init.")}ngOnDestroy(){this.staticContentReloadSubscription.unsubscribe()}loadBriefs(){$.y.staticReadonly?this.basicDataLoaderService.allMetaService.getBriefsOfPoems().subscribe(t=>{g.f.usePublished||t.sort((o,l)=>o.title.localeCompare(l.title,g.f.defaultWrittenLanguage)),this.poemBriefs=t,this.chronicle?(this.chronicle.filteredPoemBriefs=t.slice(),console.debug("this.chronicle.filteredPoemBriefs assigned.")):console.debug("chronicle not yet available."),this.waitService.setWait({loading:!1})}):this.poemsService.getBriefsOfPoems(g.f.convertZhHandler).subscribe({next:t=>{t&&(g.f.usePublished||t.sort((o,l)=>o.title.localeCompare(l.title,g.f.defaultWrittenLanguage)),this.poemBriefs=t,this.chronicle&&(this.chronicle.filteredPoemBriefs=t.slice())),this.waitService.setWait({loading:!1})},error:t=>{this.waitService.setWait({loading:!1}),this.alertService.error(t)}})}showViewSettings(){this.viewSettingsDialogService.open()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(m.c9),e.Y36(C.T.Poems),e.Y36(F.k),e.Y36(m.ii),e.Y36(X.M),e.Y36(u.vw))},n.\u0275cmp=e.Xpm({type:n,selectors:[["main-for-reader"]],features:[e.qOj],decls:15,vars:2,consts:[[1,"fixed-top"],["fxLayoutGap","1em"],["toolbar",""],["mat-button","","mat-raised-button","","mat-icon-button","","type","button",3,"click",4,"ngIf"],[1,"toolbar-spacer"],["type","button","mat-button","","mat-raised-button","","mat-icon-button","",3,"click"],["mat-button","","mat-raised-button","","mat-icon-button","","type","button",3,"click"],[3,"poemBriefs"],["chronicle",""]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"mat-toolbar",1,2),e._UZ(3,"main-buttons"),e.YNc(4,ce,3,0,"button",3),e._UZ(5,"span",4),e.TgZ(6,"button",5),e.NdJ("click",function(){return o.showViewSettings()}),e.TgZ(7,"mat-icon"),e._uU(8,"settings"),e.qZA()(),e.TgZ(9,"button",6),e.NdJ("click",function(){return o.toggleSidenav()}),e.TgZ(10,"mat-icon"),e._uU(11,"reorder"),e.qZA()()()(),e.TgZ(12,"div"),e._UZ(13,"chronicle-for-reader",7,8),e.qZA()),2&t&&(e.xp6(4),e.Q6J("ngIf",!o.isStaticReadonly),e.xp6(9),e.Q6J("poemBriefs",o.poemBriefs))},dependencies:[r.O5,R.lW,T.Hw,M.Ye,_.SQ,y.d,re],encapsulation:2}),n})();var me=a(6467);const pe=[{path:"",component:(()=>{class n extends me.w{constructor(){super()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["reader-index"]],features:[e.qOj],decls:2,vars:0,consts:[[1,"content-top-padding-relative"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"router-outlet"),e.qZA())},dependencies:[b.lC],encapsulation:2}),n})(),children:[{path:"",component:O},{path:"chronicle",component:O},{path:"albums",component:D}]}];let ue=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[b.Bz.forChild(pe),b.Bz]}),n})();var de=a(4466);let _e=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[r.ez,c.u5,c.UX,P.V,U.o9,de.m,ue]}),n})()}}]);